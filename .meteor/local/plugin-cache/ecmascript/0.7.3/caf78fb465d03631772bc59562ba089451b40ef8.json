{"metadata":{"usedHelpers":["inherits","possibleConstructorReturn","createClass","classCallCheck","extends","interopRequireDefault"],"marked":[],"modules":{"imports":[{"source":"react","imported":["default","Component","PropTypes"],"specifiers":[{"kind":"named","imported":"default","local":"React"},{"kind":"named","imported":"Component","local":"Component"},{"kind":"named","imported":"PropTypes","local":"PropTypes"}]},{"source":"radium","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"Radium"}]},{"source":"/lib/api/compose","imported":["composeWithTracker"],"specifiers":[{"kind":"named","imported":"composeWithTracker","local":"composeWithTracker"}]},{"source":"/client/api","imported":["Reaction"],"specifiers":[{"kind":"named","imported":"Reaction","local":"Reaction"}]},{"source":"classnames","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"classnames"}]},{"source":"/imports/plugins/core/layout/lib/components","imported":["getComponent"],"specifiers":[{"kind":"named","imported":"getComponent","local":"getComponent"}]},{"source":"/lib/collections","imported":["Templates"],"specifiers":[{"kind":"named","imported":"Templates","local":"Templates"}]},{"source":"/imports/plugins/core/ui/client/components","imported":["Loading"],"specifiers":[{"kind":"named","imported":"Loading","local":"Loading"}]}],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"/imports/plugins/core/layout/lib/reactionLayout.js","filenameRelative":"/imports/plugins/core/layout/lib/reactionLayout.js","inputSourceMap":{"version":3,"sources":["/imports/plugins/core/layout/lib/reactionLayout.js"],"names":["React","Component","PropTypes","Radium","composeWithTracker","Reaction","classnames","getComponent","Templates","Loading","ReactionLayout","layout","props","checkElementPermissions","block","permissions","hasAdminAccess","audience","defaultAudience","defaultPermissions","hasPermission","renderLayout","children","Array","isArray","elements","map","index","childElements","child","childIndex","type","component","createElement","key","layoutProps","element","className","rui","item","size","align","justify","axis","horizontal","vertical","style","render","propTypes","oneOfType","string","arrayOf","object","array","composer","onData","sub","Meteor","subscribe","ready","templateInfo","findOne","name","layoutName","templateData","template"],"mappings":"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","file":"/imports/plugins/core/layout/lib/reactionLayout.js.map","sourcesContent":["import React, { Component, PropTypes } from \"react\";\nimport Radium from \"radium\";\nimport { composeWithTracker } from \"/lib/api/compose\";\nimport { Reaction } from \"/client/api\";\nimport classnames from \"classnames\";\nimport { getComponent } from \"/imports/plugins/core/layout/lib/components\";\nimport { Templates } from \"/lib/collections\";\nimport { Loading } from \"/imports/plugins/core/ui/client/components\";\n\nclass ReactionLayout extends Component {\n\n  get layout() {\n    return this.props.layout;\n  }\n\n  checkElementPermissions(block) {\n    let permissions;\n    const hasAdminAccess = Reaction.hasAdminAccess();\n\n    if (hasAdminAccess === false) {\n      permissions = block.audience || this.props.defaultAudience;\n    } else {\n      permissions = block.permissions || this.props.defaultPermissions;\n    }\n\n    return Reaction.hasPermission(permissions || []);\n  }\n\n  renderLayout(children) {\n    if (!Array.isArray(children)) {\n      return null;\n    }\n\n    const elements = children.map((block, index) => {\n      let childElements;\n\n      if (Array.isArray(block.children)) {\n        childElements = block.children.map((child, childIndex) => {\n          if (child.type === \"block\") {\n            return this.renderLayout([child]);\n          }\n\n          if (this.checkElementPermissions(child)) {\n            let component = child.component;\n\n            if (typeof child.component === \"string\") {\n              component = getComponent(child.component);\n            }\n\n            return React.createElement(component, {\n              key: childIndex,\n              ...(child.props || {}),\n              ...this.props.layoutProps\n            });\n          }\n\n          return null;\n        });\n      }\n\n\n      if (this.checkElementPermissions(block)) {\n        return React.createElement(block.element || \"div\", {\n          key: index,\n          // className: classnames(`rui col-xs-${block.columns || 12}`, block.className),\n          className: classnames({\n            rui: true,\n            item: true,\n            [block.size || \"full\"]: true,\n            align: typeof block.align === \"string\",\n            [block.align || \"start\"]: true,\n            justify: typeof block.align === \"string\",\n            [block.justify || \"start\"]: true,\n            axis: true, // typeof block.axis === \"string\",\n            horizontal: block.axis === \"horizontal\",\n            vertical: block.axis !== \"horizontal\"\n          }, block.className),\n          style: block.style,\n          children: childElements\n        });\n      }\n\n      return null;\n    });\n\n    return elements;\n  }\n\n  render() {\n    return (\n        <div className=\"rui layout-base items flex\">\n          {this.renderLayout(this.layout)}\n        </div>\n    );\n  }\n}\n\nReactionLayout.propTypes = {\n  defaultAudience: PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.arrayOf(PropTypes.string)\n  ]),\n  defaultPermissions: PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.arrayOf(PropTypes.string)\n  ]),\n  layout: PropTypes.oneOfType([PropTypes.object, PropTypes.array]),\n  layoutProps: PropTypes.object\n};\n\nfunction composer(props, onData) {\n  const sub = Meteor.subscribe(\"Templates\");\n\n  if (sub.ready()) {\n    const templateInfo = Templates.findOne({\n      name: props.layoutName\n    });\n\n    if (templateInfo) {\n      const templateData = templateInfo.template;\n\n      onData(null, {\n        defaultPermissions: [\"admin\"],\n        defaultAudience: [\"guest\", \"anonymous\"],\n        layout: templateData\n      });\n    }\n  }\n}\n\nexport default composeWithTracker(composer, Loading)(Radium(ReactionLayout));\n"]},"env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"generateLetDeclarations":true,"enforceStrictMode":false}],[[],null],[[],{"polyfill":false}],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":true,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"/imports/plugins/core/layout/lib/reactionLayout.js.map","sourceFileName":"/imports/plugins/core/layout/lib/reactionLayout.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"reactionLayout"},"ignored":false,"code":"var _extends2 = require(\"babel-runtime/helpers/extends\");\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nvar _classCallCheck2 = require(\"babel-runtime/helpers/classCallCheck\");\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require(\"babel-runtime/helpers/createClass\");\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require(\"babel-runtime/helpers/possibleConstructorReturn\");\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require(\"babel-runtime/helpers/inherits\");\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nvar React = void 0,\n    Component = void 0,\n    PropTypes = void 0;\nmodule.importSync(\"react\", {\n  \"default\": function (v) {\n    React = v;\n  },\n  Component: function (v) {\n    Component = v;\n  },\n  PropTypes: function (v) {\n    PropTypes = v;\n  }\n}, 0);\nvar Radium = void 0;\nmodule.importSync(\"radium\", {\n  \"default\": function (v) {\n    Radium = v;\n  }\n}, 1);\nvar composeWithTracker = void 0;\nmodule.importSync(\"/lib/api/compose\", {\n  composeWithTracker: function (v) {\n    composeWithTracker = v;\n  }\n}, 2);\nvar Reaction = void 0;\nmodule.importSync(\"/client/api\", {\n  Reaction: function (v) {\n    Reaction = v;\n  }\n}, 3);\nvar classnames = void 0;\nmodule.importSync(\"classnames\", {\n  \"default\": function (v) {\n    classnames = v;\n  }\n}, 4);\nvar getComponent = void 0;\nmodule.importSync(\"/imports/plugins/core/layout/lib/components\", {\n  getComponent: function (v) {\n    getComponent = v;\n  }\n}, 5);\nvar Templates = void 0;\nmodule.importSync(\"/lib/collections\", {\n  Templates: function (v) {\n    Templates = v;\n  }\n}, 6);\nvar Loading = void 0;\nmodule.importSync(\"/imports/plugins/core/ui/client/components\", {\n  Loading: function (v) {\n    Loading = v;\n  }\n}, 7);\n\nvar ReactionLayout = function (_Component) {\n  (0, _inherits3.default)(ReactionLayout, _Component);\n\n  function ReactionLayout() {\n    (0, _classCallCheck3.default)(this, ReactionLayout);\n    return (0, _possibleConstructorReturn3.default)(this, _Component.apply(this, arguments));\n  }\n\n  ReactionLayout.prototype.checkElementPermissions = function () {\n    function checkElementPermissions(block) {\n      var permissions = void 0;\n      var hasAdminAccess = Reaction.hasAdminAccess();\n\n      if (hasAdminAccess === false) {\n        permissions = block.audience || this.props.defaultAudience;\n      } else {\n        permissions = block.permissions || this.props.defaultPermissions;\n      }\n\n      return Reaction.hasPermission(permissions || []);\n    }\n\n    return checkElementPermissions;\n  }();\n\n  ReactionLayout.prototype.renderLayout = function () {\n    function renderLayout(children) {\n      var _this2 = this;\n\n      if (!Array.isArray(children)) {\n        return null;\n      }\n\n      var elements = children.map(function (block, index) {\n        var childElements = void 0;\n\n        if (Array.isArray(block.children)) {\n          childElements = block.children.map(function (child, childIndex) {\n            if (child.type === \"block\") {\n              return _this2.renderLayout([child]);\n            }\n\n            if (_this2.checkElementPermissions(child)) {\n              var component = child.component;\n\n              if (typeof child.component === \"string\") {\n                component = getComponent(child.component);\n              }\n\n              return React.createElement(component, (0, _extends3.default)({\n                key: childIndex\n              }, child.props || {}, _this2.props.layoutProps));\n            }\n\n            return null;\n          });\n        }\n\n        if (_this2.checkElementPermissions(block)) {\n          var _classnames;\n\n          return React.createElement(block.element || \"div\", {\n            key: index,\n            // className: classnames(`rui col-xs-${block.columns || 12}`, block.className),\n            className: classnames((_classnames = {\n              rui: true,\n              item: true\n            }, _classnames[block.size || \"full\"] = true, _classnames.align = typeof block.align === \"string\", _classnames[block.align || \"start\"] = true, _classnames.justify = typeof block.align === \"string\", _classnames[block.justify || \"start\"] = true, _classnames.axis = true, _classnames.horizontal = block.axis === \"horizontal\", _classnames.vertical = block.axis !== \"horizontal\", _classnames), block.className),\n            style: block.style,\n            children: childElements\n          });\n        }\n\n        return null;\n      });\n      return elements;\n    }\n\n    return renderLayout;\n  }();\n\n  ReactionLayout.prototype.render = function () {\n    function render() {\n      return React.createElement(\n        \"div\",\n        {\n          className: \"rui layout-base items flex\"\n        },\n        this.renderLayout(this.layout)\n      );\n    }\n\n    return render;\n  }();\n\n  (0, _createClass3.default)(ReactionLayout, [{\n    key: \"layout\",\n    get: function () {\n      return this.props.layout;\n    }\n  }]);\n  return ReactionLayout;\n}(Component);\n\nReactionLayout.propTypes = {\n  defaultAudience: PropTypes.oneOfType([PropTypes.string, PropTypes.arrayOf(PropTypes.string)]),\n  defaultPermissions: PropTypes.oneOfType([PropTypes.string, PropTypes.arrayOf(PropTypes.string)]),\n  layout: PropTypes.oneOfType([PropTypes.object, PropTypes.array]),\n  layoutProps: PropTypes.object\n};\n\nfunction composer(props, onData) {\n  var sub = Meteor.subscribe(\"Templates\");\n\n  if (sub.ready()) {\n    var templateInfo = Templates.findOne({\n      name: props.layoutName\n    });\n\n    if (templateInfo) {\n      var templateData = templateInfo.template;\n      onData(null, {\n        defaultPermissions: [\"admin\"],\n        defaultAudience: [\"guest\", \"anonymous\"],\n        layout: templateData\n      });\n    }\n  }\n}\n\nmodule.export(\"default\", exports.default = composeWithTracker(composer, Loading)(Radium(ReactionLayout)));","map":{"version":3,"sources":["/imports/plugins/core/layout/lib/reactionLayout.js"],"names":["React","Component","PropTypes","Radium","composeWithTracker","Reaction","classnames","getComponent","Templates","Loading","ReactionLayout","layout","props","checkElementPermissions","block","permissions","hasAdminAccess","audience","defaultAudience","defaultPermissions","hasPermission","renderLayout","children","Array","isArray","elements","map","index","childElements","child","childIndex","type","component","createElement","key","layoutProps","element","className","rui","item","size","align","justify","axis","horizontal","vertical","style","render","propTypes","oneOfType","string","arrayOf","object","array","composer","onData","sub","Meteor","subscribe","ready","templateInfo","findOne","name","layoutName","templateData","template"],"mappings":"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","file":"/imports/plugins/core/layout/lib/reactionLayout.js.map","sourcesContent":["import React, { Component, PropTypes } from \"react\";\nimport Radium from \"radium\";\nimport { composeWithTracker } from \"/lib/api/compose\";\nimport { Reaction } from \"/client/api\";\nimport classnames from \"classnames\";\nimport { getComponent } from \"/imports/plugins/core/layout/lib/components\";\nimport { Templates } from \"/lib/collections\";\nimport { Loading } from \"/imports/plugins/core/ui/client/components\";\n\nclass ReactionLayout extends Component {\n\n  get layout() {\n    return this.props.layout;\n  }\n\n  checkElementPermissions(block) {\n    let permissions;\n    const hasAdminAccess = Reaction.hasAdminAccess();\n\n    if (hasAdminAccess === false) {\n      permissions = block.audience || this.props.defaultAudience;\n    } else {\n      permissions = block.permissions || this.props.defaultPermissions;\n    }\n\n    return Reaction.hasPermission(permissions || []);\n  }\n\n  renderLayout(children) {\n    if (!Array.isArray(children)) {\n      return null;\n    }\n\n    const elements = children.map((block, index) => {\n      let childElements;\n\n      if (Array.isArray(block.children)) {\n        childElements = block.children.map((child, childIndex) => {\n          if (child.type === \"block\") {\n            return this.renderLayout([child]);\n          }\n\n          if (this.checkElementPermissions(child)) {\n            let component = child.component;\n\n            if (typeof child.component === \"string\") {\n              component = getComponent(child.component);\n            }\n\n            return React.createElement(component, {\n              key: childIndex,\n              ...(child.props || {}),\n              ...this.props.layoutProps\n            });\n          }\n\n          return null;\n        });\n      }\n\n\n      if (this.checkElementPermissions(block)) {\n        return React.createElement(block.element || \"div\", {\n          key: index,\n          // className: classnames(`rui col-xs-${block.columns || 12}`, block.className),\n          className: classnames({\n            rui: true,\n            item: true,\n            [block.size || \"full\"]: true,\n            align: typeof block.align === \"string\",\n            [block.align || \"start\"]: true,\n            justify: typeof block.align === \"string\",\n            [block.justify || \"start\"]: true,\n            axis: true, // typeof block.axis === \"string\",\n            horizontal: block.axis === \"horizontal\",\n            vertical: block.axis !== \"horizontal\"\n          }, block.className),\n          style: block.style,\n          children: childElements\n        });\n      }\n\n      return null;\n    });\n\n    return elements;\n  }\n\n  render() {\n    return (\n        <div className=\"rui layout-base items flex\">\n          {this.renderLayout(this.layout)}\n        </div>\n    );\n  }\n}\n\nReactionLayout.propTypes = {\n  defaultAudience: PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.arrayOf(PropTypes.string)\n  ]),\n  defaultPermissions: PropTypes.oneOfType([\n    PropTypes.string,\n    PropTypes.arrayOf(PropTypes.string)\n  ]),\n  layout: PropTypes.oneOfType([PropTypes.object, PropTypes.array]),\n  layoutProps: PropTypes.object\n};\n\nfunction composer(props, onData) {\n  const sub = Meteor.subscribe(\"Templates\");\n\n  if (sub.ready()) {\n    const templateInfo = Templates.findOne({\n      name: props.layoutName\n    });\n\n    if (templateInfo) {\n      const templateData = templateInfo.template;\n\n      onData(null, {\n        defaultPermissions: [\"admin\"],\n        defaultAudience: [\"guest\", \"anonymous\"],\n        layout: templateData\n      });\n    }\n  }\n}\n\nexport default composeWithTracker(composer, Loading)(Radium(ReactionLayout));\n"]},"hash":"caf78fb465d03631772bc59562ba089451b40ef8"}
