{"metadata":{"usedHelpers":["inherits","possibleConstructorReturn","classCallCheck","extends","interopRequireDefault"],"marked":[],"modules":{"imports":[{"source":"react","imported":["default","Component","PropTypes"],"specifiers":[{"kind":"named","imported":"default","local":"React"},{"kind":"named","imported":"Component","local":"Component"},{"kind":"named","imported":"PropTypes","local":"PropTypes"}]},{"source":"meteor/meteor","imported":["Meteor"],"specifiers":[{"kind":"named","imported":"Meteor","local":"Meteor"}]},{"source":"/lib/api/compose","imported":["composeWithTracker"],"specifiers":[{"kind":"named","imported":"composeWithTracker","local":"composeWithTracker"}]},{"source":"/client/api","imported":["Router"],"specifiers":[{"kind":"named","imported":"Router","local":"Router"}]},{"source":"/lib/api","imported":["ReactionProduct"],"specifiers":[{"kind":"named","imported":"ReactionProduct","local":"ReactionProduct"}]},{"source":"/lib/collections","imported":["Tags","Media","Products"],"specifiers":[{"kind":"named","imported":"Tags","local":"Tags"},{"kind":"named","imported":"Media","local":"Media"},{"kind":"named","imported":"Products","local":"Products"}]},{"source":"/imports/plugins/core/revisions/client/containers/publishContainer","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"PublishContainer"}]}],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"/imports/plugins/included/product-detail-simple/client/containers/publishContainer.js","filenameRelative":"/imports/plugins/included/product-detail-simple/client/containers/publishContainer.js","inputSourceMap":{"version":3,"sources":["/imports/plugins/included/product-detail-simple/client/containers/publishContainer.js"],"names":["React","Component","PropTypes","Meteor","composeWithTracker","Router","ReactionProduct","Tags","Media","Products","PublishContainer","ProductPublishContainer","handleMetaRemove","productId","metafield","call","handleProductRestore","product","_id","handleVisibilityChange","event","isProductVisible","props","variants","find","ancestors","$in","fetch","map","variant","handlePublishActions","action","documentIds","archiveProduct","handlePublishSuccess","result","status","productDocument","previousDocuments","handle","newProductPath","pathFor","hash","window","location","href","render","composer","onData","selectedProduct","revisonDocumentIds","_","isArray","hashtags","tags","id","findOne","selectedVariant","media","sort","documents","propTypes","object","arrayOf"],"mappings":"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","file":"/imports/plugins/included/product-detail-simple/client/containers/publishContainer.js.map","sourcesContent":["import React, { Component, PropTypes } from \"react\";\nimport { Meteor } from \"meteor/meteor\";\nimport { composeWithTracker } from \"/lib/api/compose\";\nimport { Router } from \"/client/api\";\nimport { ReactionProduct } from \"/lib/api\";\nimport { Tags, Media, Products } from \"/lib/collections\";\nimport PublishContainer from \"/imports/plugins/core/revisions/client/containers/publishContainer\";\n\nclass ProductPublishContainer extends Component {\n  handleMetaRemove = (productId, metafield) => {\n    Meteor.call(\"products/removeMetaFields\", productId, metafield);\n  }\n\n  handleProductRestore = (product) => {\n    Meteor.call(\"products/updateProductField\", product._id, \"isDeleted\", false);\n  }\n\n  handleVisibilityChange = (event, isProductVisible) => {\n    // Update main product\n    Meteor.call(\"products/updateProductField\", this.props.product._id, \"isVisible\", isProductVisible);\n\n    const variants = Products.find({\n      ancestors: {\n        $in: [this.props.product._id]\n      }\n    }).fetch();\n\n    variants.map(variant => {\n      // update variant\n      Meteor.call(\"products/updateProductField\", variant._id, \"isVisible\", isProductVisible);\n    });\n  }\n\n  handlePublishActions = (event, action, documentIds) => {\n    if (action === \"archive\") {\n      ReactionProduct.archiveProduct(documentIds);\n    }\n  }\n\n  handlePublishSuccess = (result) => {\n    if (result && result.status === \"success\" && this.props.product) {\n      const productDocument = result.previousDocuments.find((product) => this.props.product._id === product._id);\n\n      if (productDocument && this.props.product.handle !== productDocument.handle) {\n        const newProductPath = Router.pathFor(\"product\", {\n          hash: {\n            handle: this.props.product.handle\n          }\n        });\n\n        window.location.href = newProductPath;\n      }\n    }\n  }\n\n  render() {\n    return (\n      <PublishContainer\n        onAction={this.handlePublishActions}\n        onPublishSuccess={this.handlePublishSuccess}\n        onVisibilityChange={this.handleVisibilityChange}\n        {...this.props}\n      />\n    );\n  }\n}\n\n\nfunction composer(props, onData) {\n  const product = ReactionProduct.selectedProduct();\n  let revisonDocumentIds;\n\n  if (product) {\n    if (_.isArray(product.hashtags)) {\n      tags = _.map(product.hashtags, function (id) {\n        return Tags.findOne(id);\n      });\n    }\n\n    const selectedVariant = ReactionProduct.selectedVariant();\n\n    if (selectedVariant) {\n      media = Media.find({\n        \"metadata.variantId\": selectedVariant._id\n      }, {\n        sort: {\n          \"metadata.priority\": 1\n        }\n      });\n    }\n\n    revisonDocumentIds = [product._id];\n\n    onData(null, {\n      product,\n      documentIds: revisonDocumentIds,\n      documents: [product]\n    });\n  } else {\n    onData(null, {});\n  }\n}\n\nProductPublishContainer.propTypes = {\n  product: PropTypes.object,\n  tags: PropTypes.arrayOf(PropTypes.object)\n};\n\n// Decorate component and export\nexport default composeWithTracker(composer)(ProductPublishContainer);\n"]},"env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"generateLetDeclarations":true,"enforceStrictMode":false}],[[],null],[[],{"polyfill":false}],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":true,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"/imports/plugins/included/product-detail-simple/client/containers/publishContainer.js.map","sourceFileName":"/imports/plugins/included/product-detail-simple/client/containers/publishContainer.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"publishContainer"},"ignored":false,"code":"var _extends2 = require(\"babel-runtime/helpers/extends\");\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nvar _classCallCheck2 = require(\"babel-runtime/helpers/classCallCheck\");\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _possibleConstructorReturn2 = require(\"babel-runtime/helpers/possibleConstructorReturn\");\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require(\"babel-runtime/helpers/inherits\");\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nvar React = void 0,\n    Component = void 0,\n    PropTypes = void 0;\nmodule.importSync(\"react\", {\n  \"default\": function (v) {\n    React = v;\n  },\n  Component: function (v) {\n    Component = v;\n  },\n  PropTypes: function (v) {\n    PropTypes = v;\n  }\n}, 0);\nvar Meteor = void 0;\nmodule.importSync(\"meteor/meteor\", {\n  Meteor: function (v) {\n    Meteor = v;\n  }\n}, 1);\nvar composeWithTracker = void 0;\nmodule.importSync(\"/lib/api/compose\", {\n  composeWithTracker: function (v) {\n    composeWithTracker = v;\n  }\n}, 2);\nvar Router = void 0;\nmodule.importSync(\"/client/api\", {\n  Router: function (v) {\n    Router = v;\n  }\n}, 3);\nvar ReactionProduct = void 0;\nmodule.importSync(\"/lib/api\", {\n  ReactionProduct: function (v) {\n    ReactionProduct = v;\n  }\n}, 4);\nvar Tags = void 0,\n    Media = void 0,\n    Products = void 0;\nmodule.importSync(\"/lib/collections\", {\n  Tags: function (v) {\n    Tags = v;\n  },\n  Media: function (v) {\n    Media = v;\n  },\n  Products: function (v) {\n    Products = v;\n  }\n}, 5);\nvar PublishContainer = void 0;\nmodule.importSync(\"/imports/plugins/core/revisions/client/containers/publishContainer\", {\n  \"default\": function (v) {\n    PublishContainer = v;\n  }\n}, 6);\n\nvar ProductPublishContainer = function (_Component) {\n  (0, _inherits3.default)(ProductPublishContainer, _Component);\n\n  function ProductPublishContainer() {\n    var _temp, _this, _ret;\n\n    (0, _classCallCheck3.default)(this, ProductPublishContainer);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = (0, _possibleConstructorReturn3.default)(this, _Component.call.apply(_Component, [this].concat(args))), _this), _this.handleMetaRemove = function (productId, metafield) {\n      Meteor.call(\"products/removeMetaFields\", productId, metafield);\n    }, _this.handleProductRestore = function (product) {\n      Meteor.call(\"products/updateProductField\", product._id, \"isDeleted\", false);\n    }, _this.handleVisibilityChange = function (event, isProductVisible) {\n      // Update main product\n      Meteor.call(\"products/updateProductField\", _this.props.product._id, \"isVisible\", isProductVisible);\n      var variants = Products.find({\n        ancestors: {\n          $in: [_this.props.product._id]\n        }\n      }).fetch();\n      variants.map(function (variant) {\n        // update variant\n        Meteor.call(\"products/updateProductField\", variant._id, \"isVisible\", isProductVisible);\n      });\n    }, _this.handlePublishActions = function (event, action, documentIds) {\n      if (action === \"archive\") {\n        ReactionProduct.archiveProduct(documentIds);\n      }\n    }, _this.handlePublishSuccess = function (result) {\n      if (result && result.status === \"success\" && _this.props.product) {\n        var productDocument = result.previousDocuments.find(function (product) {\n          return _this.props.product._id === product._id;\n        });\n\n        if (productDocument && _this.props.product.handle !== productDocument.handle) {\n          var newProductPath = Router.pathFor(\"product\", {\n            hash: {\n              handle: _this.props.product.handle\n            }\n          });\n          window.location.href = newProductPath;\n        }\n      }\n    }, _temp), (0, _possibleConstructorReturn3.default)(_this, _ret);\n  }\n\n  ProductPublishContainer.prototype.render = function () {\n    function render() {\n      return React.createElement(PublishContainer, (0, _extends3.default)({\n        onAction: this.handlePublishActions,\n        onPublishSuccess: this.handlePublishSuccess,\n        onVisibilityChange: this.handleVisibilityChange\n      }, this.props));\n    }\n\n    return render;\n  }();\n\n  return ProductPublishContainer;\n}(Component);\n\nfunction composer(props, onData) {\n  var product = ReactionProduct.selectedProduct();\n  var revisonDocumentIds = void 0;\n\n  if (product) {\n    if (_.isArray(product.hashtags)) {\n      tags = _.map(product.hashtags, function (id) {\n        return Tags.findOne(id);\n      });\n    }\n\n    var selectedVariant = ReactionProduct.selectedVariant();\n\n    if (selectedVariant) {\n      media = Media.find({\n        \"metadata.variantId\": selectedVariant._id\n      }, {\n        sort: {\n          \"metadata.priority\": 1\n        }\n      });\n    }\n\n    revisonDocumentIds = [product._id];\n    onData(null, {\n      product: product,\n      documentIds: revisonDocumentIds,\n      documents: [product]\n    });\n  } else {\n    onData(null, {});\n  }\n}\n\nProductPublishContainer.propTypes = {\n  product: PropTypes.object,\n  tags: PropTypes.arrayOf(PropTypes.object)\n}; // Decorate component and export\n\nmodule.export(\"default\", exports.default = composeWithTracker(composer)(ProductPublishContainer));","map":{"version":3,"sources":["/imports/plugins/included/product-detail-simple/client/containers/publishContainer.js"],"names":["React","Component","PropTypes","Meteor","composeWithTracker","Router","ReactionProduct","Tags","Media","Products","PublishContainer","ProductPublishContainer","handleMetaRemove","productId","metafield","call","handleProductRestore","product","_id","handleVisibilityChange","event","isProductVisible","props","variants","find","ancestors","$in","fetch","map","variant","handlePublishActions","action","documentIds","archiveProduct","handlePublishSuccess","result","status","productDocument","previousDocuments","handle","newProductPath","pathFor","hash","window","location","href","render","composer","onData","selectedProduct","revisonDocumentIds","_","isArray","hashtags","tags","id","findOne","selectedVariant","media","sort","documents","propTypes","object","arrayOf"],"mappings":"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","file":"/imports/plugins/included/product-detail-simple/client/containers/publishContainer.js.map","sourcesContent":["import React, { Component, PropTypes } from \"react\";\nimport { Meteor } from \"meteor/meteor\";\nimport { composeWithTracker } from \"/lib/api/compose\";\nimport { Router } from \"/client/api\";\nimport { ReactionProduct } from \"/lib/api\";\nimport { Tags, Media, Products } from \"/lib/collections\";\nimport PublishContainer from \"/imports/plugins/core/revisions/client/containers/publishContainer\";\n\nclass ProductPublishContainer extends Component {\n  handleMetaRemove = (productId, metafield) => {\n    Meteor.call(\"products/removeMetaFields\", productId, metafield);\n  }\n\n  handleProductRestore = (product) => {\n    Meteor.call(\"products/updateProductField\", product._id, \"isDeleted\", false);\n  }\n\n  handleVisibilityChange = (event, isProductVisible) => {\n    // Update main product\n    Meteor.call(\"products/updateProductField\", this.props.product._id, \"isVisible\", isProductVisible);\n\n    const variants = Products.find({\n      ancestors: {\n        $in: [this.props.product._id]\n      }\n    }).fetch();\n\n    variants.map(variant => {\n      // update variant\n      Meteor.call(\"products/updateProductField\", variant._id, \"isVisible\", isProductVisible);\n    });\n  }\n\n  handlePublishActions = (event, action, documentIds) => {\n    if (action === \"archive\") {\n      ReactionProduct.archiveProduct(documentIds);\n    }\n  }\n\n  handlePublishSuccess = (result) => {\n    if (result && result.status === \"success\" && this.props.product) {\n      const productDocument = result.previousDocuments.find((product) => this.props.product._id === product._id);\n\n      if (productDocument && this.props.product.handle !== productDocument.handle) {\n        const newProductPath = Router.pathFor(\"product\", {\n          hash: {\n            handle: this.props.product.handle\n          }\n        });\n\n        window.location.href = newProductPath;\n      }\n    }\n  }\n\n  render() {\n    return (\n      <PublishContainer\n        onAction={this.handlePublishActions}\n        onPublishSuccess={this.handlePublishSuccess}\n        onVisibilityChange={this.handleVisibilityChange}\n        {...this.props}\n      />\n    );\n  }\n}\n\n\nfunction composer(props, onData) {\n  const product = ReactionProduct.selectedProduct();\n  let revisonDocumentIds;\n\n  if (product) {\n    if (_.isArray(product.hashtags)) {\n      tags = _.map(product.hashtags, function (id) {\n        return Tags.findOne(id);\n      });\n    }\n\n    const selectedVariant = ReactionProduct.selectedVariant();\n\n    if (selectedVariant) {\n      media = Media.find({\n        \"metadata.variantId\": selectedVariant._id\n      }, {\n        sort: {\n          \"metadata.priority\": 1\n        }\n      });\n    }\n\n    revisonDocumentIds = [product._id];\n\n    onData(null, {\n      product,\n      documentIds: revisonDocumentIds,\n      documents: [product]\n    });\n  } else {\n    onData(null, {});\n  }\n}\n\nProductPublishContainer.propTypes = {\n  product: PropTypes.object,\n  tags: PropTypes.arrayOf(PropTypes.object)\n};\n\n// Decorate component and export\nexport default composeWithTracker(composer)(ProductPublishContainer);\n"]},"hash":"5b3aabd1992f79fc024ab05e0902d904bf14d30a"}
