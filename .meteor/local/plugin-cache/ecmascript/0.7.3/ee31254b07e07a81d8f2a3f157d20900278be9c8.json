{"metadata":{"usedHelpers":[],"marked":[],"modules":{"imports":[{"source":"url","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"url"}]},{"source":"meteor/browser-policy-common","imported":["BrowserPolicy"],"specifiers":[{"kind":"named","imported":"BrowserPolicy","local":"BrowserPolicy"}]},{"source":"meteor/webapp","imported":["WebApp"],"specifiers":[{"kind":"named","imported":"WebApp","local":"WebApp"}]}],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"/server/security/policy.js","filenameRelative":"/server/security/policy.js","inputSourceMap":{"version":3,"sources":["/server/security/policy.js"],"names":["url","BrowserPolicy","WebApp","rawConnectHandlers","use","req","res","next","_parsedUrl","pathname","match","setHeader","process","env","NODE_ENV","content","allowOriginForAll","allowConnectOrigin","framing","allowAll","hostname","parse","Meteor","absoluteUrl","allowImageOrigin","allowFontDataUrl"],"mappings":"AAAA,IAAO;AAAP,OAAA,AAAgB;;;;;;;;;;;;;;;;GAChB,AAAS,AAAqB,AAC9B,AAAS,AAAc,AAGvB,A;AAGA,AAAO,AAAmB,AAAI,AAAC,AAAK,AAAK,AAAS,AAChD,AAAI,AAAI,AAAW,AAAS,AAAM,AAAgD,AAChF,AAAI,AAAU,AAA+B;;;oFAE/C;iDAJF,AAKC;AAGD,A;;;AAGA,AAAI,AAAQ,AAAI,AAAa,AAAe,CARzC,GASD,AAAc,AAAQ,AAAkB,AACxC,AAAc,AAAQ,AAAmB,AACzC,AAAc,AAAQ,AAAmB;;;;AACzC,gBAAA,AAAc,AAAQ,aAAtB,AAAyC,eAAzC,AACA;gBAAA,AAAc,QAAd,AAAsB,kBACvB,A;AAED;;2CACA;AAAM,wBAAE;AAAF,A,AAAN,AAAqB,AAAI,AAAM,AAAO,AAEtC,EACA;;;iBAAA,AAAsB,iBAAtB,AAA0C,AAAO,AAAS,AAC1D,AAAc,AAAQ,AAAoB,AAAQ,AAAS;IAD7C,gCAGd,AAAc,AAAQ,AAAkB;;;AACxC,cAAA,AAAc,QAAd,AAAsB,AAAkB,6BAAxC;AACA,cAAA,AAAc,QAAd,AAAsB,AAAkB,8BAAxC,AACA,AAAc,AAAQ,AAAkB;AAExC,cAAA,AAAc,QAAd,AAAsB,AAAiB,kBAAvC;AACA,cAAA,AAAc,QAAd,AAAsB,AAAiB,kBAAvC;AACA,cAAA,AAAc,QAAd,AAAsB,AAAiB,kBAAvC;AAEA,cAAA,AAAc,QAAd,AAAsB,kBACtB,AAAc,AAAQ,AAAkB;AACxC,cAAA,AAAc,QAAQ,iBAAtB,AAAwC;AACxC,cAAA,AAAc,QAAQ,iBAAtB,AAAwC;AACxC,cAAA,AAAc,QAAQ,iBAAtB,AAAwC,AACxC,AAAc,AAAQ,AAAkB;AAExC,cAAA,AAAc,QAAd,AAAsB,AAAkB;AACxC,cAAA,AAAc,QAAd,AAAsB,kBAAtB,AAAwC","file":"/server/security/policy.js.map","sourcesContent":["import url from \"url\";\nimport { BrowserPolicy } from \"meteor/browser-policy-common\";\nimport { WebApp } from \"meteor/webapp\";\n\n\n/**\n * Set headers for Reaction CDN\n */\nWebApp.rawConnectHandlers.use((req, res, next) => {\n  if (req._parsedUrl.pathname.match(/\\.(ttf|ttc|otf|eot|woff|svg|font\\.css|css)$/)) {\n    res.setHeader(\"Access-Control-Allow-Origin\", \"assets.reactioncommerce.com\");\n  }\n  next();\n});\n\n\n/**\n * Set browser policies\n */\nif (process.env.NODE_ENV === \"development\") {\n  BrowserPolicy.content.allowOriginForAll(\"localhost:*\");\n  BrowserPolicy.content.allowConnectOrigin(\"ws://localhost:*\");\n  BrowserPolicy.content.allowConnectOrigin(\"http://localhost:*\");\n  BrowserPolicy.content.allowConnectOrigin(\"https://localhost:*\");\n  BrowserPolicy.framing.allowAll();\n}\n\n// get current hostname of app\nconst { hostname } = url.parse(Meteor.absoluteUrl());\n\n// allow websockets (Safari fails without this)\nBrowserPolicy.content.allowConnectOrigin(`ws://${hostname}`);\nBrowserPolicy.content.allowConnectOrigin(`wss://${hostname}`);\n\nBrowserPolicy.content.allowOriginForAll(\"*.facebook.com\");\nBrowserPolicy.content.allowOriginForAll(\"*.fbcdn.net\");\nBrowserPolicy.content.allowOriginForAll(\"connect.facebook.net\");\nBrowserPolicy.content.allowOriginForAll(\"*.googleusercontent.com\");\n\nBrowserPolicy.content.allowImageOrigin(\"fbcdn-profile-a.akamaihd.net\");\nBrowserPolicy.content.allowImageOrigin(\"secure.gravatar.com\");\nBrowserPolicy.content.allowImageOrigin(\"i0.wp.com\");\n\nBrowserPolicy.content.allowFontDataUrl();\nBrowserPolicy.content.allowOriginForAll(\"assets.reactioncommerce.com\");\nBrowserPolicy.content.allowOriginForAll(\"cdnjs.cloudflare.com\");\nBrowserPolicy.content.allowOriginForAll(\"fonts.googleapis.com\");\nBrowserPolicy.content.allowOriginForAll(\"fonts.gstatic.com\");\nBrowserPolicy.content.allowOriginForAll(\"fonts.gstatic.com\");\n\nBrowserPolicy.content.allowOriginForAll(\"enginex.kadira.io\");\nBrowserPolicy.content.allowOriginForAll(\"*.stripe.com\");\n"]},"env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"generateLetDeclarations":true,"enforceStrictMode":false}],[[],null],[[],{"polyfill":false}],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":true,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"/server/security/policy.js.map","sourceFileName":"/server/security/policy.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"policy"},"ignored":false,"code":"var url = void 0;\nmodule.importSync(\"url\", {\n  \"default\": function (v) {\n    url = v;\n  }\n}, 0);\nvar BrowserPolicy = void 0;\nmodule.importSync(\"meteor/browser-policy-common\", {\n  BrowserPolicy: function (v) {\n    BrowserPolicy = v;\n  }\n}, 1);\nvar WebApp = void 0;\nmodule.importSync(\"meteor/webapp\", {\n  WebApp: function (v) {\n    WebApp = v;\n  }\n}, 2);\n/**\n * Set headers for Reaction CDN\n */WebApp.rawConnectHandlers.use(function (req, res, next) {\n  if (req._parsedUrl.pathname.match(/\\.(ttf|ttc|otf|eot|woff|svg|font\\.css|css)$/)) {\n    res.setHeader(\"Access-Control-Allow-Origin\", \"assets.reactioncommerce.com\");\n  }\n\n  next();\n}); /**\n     * Set browser policies\n     */\n\nif (process.env.NODE_ENV === \"development\") {\n  BrowserPolicy.content.allowOriginForAll(\"localhost:*\");\n  BrowserPolicy.content.allowConnectOrigin(\"ws://localhost:*\");\n  BrowserPolicy.content.allowConnectOrigin(\"http://localhost:*\");\n  BrowserPolicy.content.allowConnectOrigin(\"https://localhost:*\");\n  BrowserPolicy.framing.allowAll();\n} // get current hostname of app\n\n\nvar _url$parse = url.parse(Meteor.absoluteUrl()),\n    hostname = _url$parse.hostname; // allow websockets (Safari fails without this)\n\n\nBrowserPolicy.content.allowConnectOrigin(\"ws://\" + hostname);\nBrowserPolicy.content.allowConnectOrigin(\"wss://\" + hostname);\nBrowserPolicy.content.allowOriginForAll(\"*.facebook.com\");\nBrowserPolicy.content.allowOriginForAll(\"*.fbcdn.net\");\nBrowserPolicy.content.allowOriginForAll(\"connect.facebook.net\");\nBrowserPolicy.content.allowOriginForAll(\"*.googleusercontent.com\");\nBrowserPolicy.content.allowImageOrigin(\"fbcdn-profile-a.akamaihd.net\");\nBrowserPolicy.content.allowImageOrigin(\"secure.gravatar.com\");\nBrowserPolicy.content.allowImageOrigin(\"i0.wp.com\");\nBrowserPolicy.content.allowFontDataUrl();\nBrowserPolicy.content.allowOriginForAll(\"assets.reactioncommerce.com\");\nBrowserPolicy.content.allowOriginForAll(\"cdnjs.cloudflare.com\");\nBrowserPolicy.content.allowOriginForAll(\"fonts.googleapis.com\");\nBrowserPolicy.content.allowOriginForAll(\"fonts.gstatic.com\");\nBrowserPolicy.content.allowOriginForAll(\"fonts.gstatic.com\");\nBrowserPolicy.content.allowOriginForAll(\"enginex.kadira.io\");\nBrowserPolicy.content.allowOriginForAll(\"*.stripe.com\");","map":{"version":3,"sources":["/server/security/policy.js"],"names":["url","BrowserPolicy","WebApp","rawConnectHandlers","use","req","res","next","_parsedUrl","pathname","match","setHeader","process","env","NODE_ENV","content","allowOriginForAll","allowConnectOrigin","framing","allowAll","hostname","parse","Meteor","absoluteUrl","allowImageOrigin","allowFontDataUrl"],"mappings":"AAAA,IAAO;AAAP,OAAA,AAAgB;;;;;;;;;;;;;;;;GAChB,AAAS,AAAqB,AAC9B,AAAS,AAAc,AAGvB,A;AAGA,AAAO,AAAmB,AAAI,AAAC,AAAK,AAAK,AAAS,AAChD,AAAI,AAAI,AAAW,AAAS,AAAM,AAAgD,AAChF,AAAI,AAAU,AAA+B;;;oFAE/C;iDAJF,AAKC;AAGD,A;;;AAGA,AAAI,AAAQ,AAAI,AAAa,AAAe,CARzC,GASD,AAAc,AAAQ,AAAkB,AACxC,AAAc,AAAQ,AAAmB,AACzC,AAAc,AAAQ,AAAmB;;;;AACzC,gBAAA,AAAc,AAAQ,aAAtB,AAAyC,eAAzC,AACA;gBAAA,AAAc,QAAd,AAAsB,kBACvB,A;AAED;;2CACA;AAAM,wBAAE;AAAF,A,AAAN,AAAqB,AAAI,AAAM,AAAO,AAEtC,EACA;;;iBAAA,AAAsB,iBAAtB,AAA0C,AAAO,AAAS,AAC1D,AAAc,AAAQ,AAAoB,AAAQ,AAAS;IAD7C,gCAGd,AAAc,AAAQ,AAAkB;;;AACxC,cAAA,AAAc,QAAd,AAAsB,AAAkB,6BAAxC;AACA,cAAA,AAAc,QAAd,AAAsB,AAAkB,8BAAxC,AACA,AAAc,AAAQ,AAAkB;AAExC,cAAA,AAAc,QAAd,AAAsB,AAAiB,kBAAvC;AACA,cAAA,AAAc,QAAd,AAAsB,AAAiB,kBAAvC;AACA,cAAA,AAAc,QAAd,AAAsB,AAAiB,kBAAvC;AAEA,cAAA,AAAc,QAAd,AAAsB,kBACtB,AAAc,AAAQ,AAAkB;AACxC,cAAA,AAAc,QAAQ,iBAAtB,AAAwC;AACxC,cAAA,AAAc,QAAQ,iBAAtB,AAAwC;AACxC,cAAA,AAAc,QAAQ,iBAAtB,AAAwC,AACxC,AAAc,AAAQ,AAAkB;AAExC,cAAA,AAAc,QAAd,AAAsB,AAAkB;AACxC,cAAA,AAAc,QAAd,AAAsB,kBAAtB,AAAwC","file":"/server/security/policy.js.map","sourcesContent":["import url from \"url\";\nimport { BrowserPolicy } from \"meteor/browser-policy-common\";\nimport { WebApp } from \"meteor/webapp\";\n\n\n/**\n * Set headers for Reaction CDN\n */\nWebApp.rawConnectHandlers.use((req, res, next) => {\n  if (req._parsedUrl.pathname.match(/\\.(ttf|ttc|otf|eot|woff|svg|font\\.css|css)$/)) {\n    res.setHeader(\"Access-Control-Allow-Origin\", \"assets.reactioncommerce.com\");\n  }\n  next();\n});\n\n\n/**\n * Set browser policies\n */\nif (process.env.NODE_ENV === \"development\") {\n  BrowserPolicy.content.allowOriginForAll(\"localhost:*\");\n  BrowserPolicy.content.allowConnectOrigin(\"ws://localhost:*\");\n  BrowserPolicy.content.allowConnectOrigin(\"http://localhost:*\");\n  BrowserPolicy.content.allowConnectOrigin(\"https://localhost:*\");\n  BrowserPolicy.framing.allowAll();\n}\n\n// get current hostname of app\nconst { hostname } = url.parse(Meteor.absoluteUrl());\n\n// allow websockets (Safari fails without this)\nBrowserPolicy.content.allowConnectOrigin(`ws://${hostname}`);\nBrowserPolicy.content.allowConnectOrigin(`wss://${hostname}`);\n\nBrowserPolicy.content.allowOriginForAll(\"*.facebook.com\");\nBrowserPolicy.content.allowOriginForAll(\"*.fbcdn.net\");\nBrowserPolicy.content.allowOriginForAll(\"connect.facebook.net\");\nBrowserPolicy.content.allowOriginForAll(\"*.googleusercontent.com\");\n\nBrowserPolicy.content.allowImageOrigin(\"fbcdn-profile-a.akamaihd.net\");\nBrowserPolicy.content.allowImageOrigin(\"secure.gravatar.com\");\nBrowserPolicy.content.allowImageOrigin(\"i0.wp.com\");\n\nBrowserPolicy.content.allowFontDataUrl();\nBrowserPolicy.content.allowOriginForAll(\"assets.reactioncommerce.com\");\nBrowserPolicy.content.allowOriginForAll(\"cdnjs.cloudflare.com\");\nBrowserPolicy.content.allowOriginForAll(\"fonts.googleapis.com\");\nBrowserPolicy.content.allowOriginForAll(\"fonts.gstatic.com\");\nBrowserPolicy.content.allowOriginForAll(\"fonts.gstatic.com\");\n\nBrowserPolicy.content.allowOriginForAll(\"enginex.kadira.io\");\nBrowserPolicy.content.allowOriginForAll(\"*.stripe.com\");\n"]},"hash":"ee31254b07e07a81d8f2a3f157d20900278be9c8"}
