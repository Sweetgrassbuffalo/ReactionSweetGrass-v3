{"metadata":{"usedHelpers":["inherits","possibleConstructorReturn","classCallCheck","extends","typeof","interopRequireDefault"],"marked":[],"modules":{"imports":[{"source":"react","imported":["default","Component"],"specifiers":[{"kind":"named","imported":"default","local":"React"},{"kind":"named","imported":"Component","local":"Component"}]},{"source":"meteor/meteor","imported":["Meteor"],"specifiers":[{"kind":"named","imported":"Meteor","local":"Meteor"}]},{"source":"/client/api","imported":["Reaction","i18next"],"specifiers":[{"kind":"named","imported":"Reaction","local":"Reaction"},{"kind":"named","imported":"i18next","local":"i18next"}]},{"source":"/lib/api/compose","imported":["composeWithTracker"],"specifiers":[{"kind":"named","imported":"composeWithTracker","local":"composeWithTracker"}]},{"source":"/client/collections","imported":["Countries"],"specifiers":[{"kind":"named","imported":"Countries","local":"Countries"}]},{"source":"/lib/collections","imported":["Shops"],"specifiers":[{"kind":"named","imported":"Shops","local":"Shops"}]},{"source":"../components/localizationSettings","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"LocalizationSettings"}]}],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"/imports/plugins/core/i18n/client/containers/localizationSettingsContainer.js","filenameRelative":"/imports/plugins/core/i18n/client/containers/localizationSettingsContainer.js","inputSourceMap":{"version":3,"sources":["/imports/plugins/core/i18n/client/containers/localizationSettingsContainer.js"],"names":["React","Component","Meteor","Reaction","i18next","composeWithTracker","Countries","Shops","LocalizationSettings","LocalizationSettingsContainer","propTypes","handleUpdateLanguageConfiguration","event","isChecked","name","language","props","languages","find","l","value","call","handleUpdateCurrencyConfiguration","handleSubmit","doc","update","_id","$set","timezone","currency","baseUOM","handleEnableAllLanguages","isEnabled","handleEnableAllCurrencies","render","composer","onData","shop","findOne","countries","fetch","preferences","getUserPreferences","i18nKey","label","toLowerCase","push","i18n","enabled","currencies","currencyList","currencyOptions","hasOwnProperty","structure","symbol","format","unitsOfMeasure","uomOptions","measure","t","uom","defaultValue","timezoneOptions","timezones","moment","tz","names","enabledLanguages","filter","countryOptions","decoratedComponent"],"mappings":"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","file":"/imports/plugins/core/i18n/client/containers/localizationSettingsContainer.js.map","sourcesContent":["import React, { Component } from \"react\";\nimport { Meteor } from \"meteor/meteor\";\nimport { Reaction, i18next } from \"/client/api\";\nimport { composeWithTracker } from \"/lib/api/compose\";\nimport { Countries } from \"/client/collections\";\nimport { Shops } from \"/lib/collections\";\nimport LocalizationSettings from \"../components/localizationSettings\";\n\nclass LocalizationSettingsContainer extends Component {\n  static propTypes = LocalizationSettings.propTypes\n\n  handleUpdateLanguageConfiguration = (event, isChecked, name) => {\n    const language = this.props.languages.find((l) => l.value === name);\n\n    if (language) {\n      Meteor.call(\"shop/updateLanguageConfiguration\", language.value, isChecked);\n    }\n  }\n\n  handleUpdateCurrencyConfiguration = (event, isChecked, name) => {\n    Meteor.call(\"shop/updateCurrencyConfiguration\", name, isChecked);\n  }\n\n  handleSubmit = (doc) => {\n    Shops.update({\n      _id: doc._id\n    }, {\n      $set: {\n        timezone: doc.timezone,\n        currency: doc.currency,\n        baseUOM: doc.baseUOM,\n        language: doc.language\n      }\n    });\n  }\n\n  handleEnableAllLanguages = (isEnabled) => {\n    Meteor.call(\"shop/updateLanguageConfiguration\", \"all\", isEnabled);\n  }\n\n  handleEnableAllCurrencies = (isEnabled) => {\n    Meteor.call(\"shop/updateCurrencyConfiguration\", \"all\", isEnabled);\n  }\n\n  render() {\n    return (\n      <LocalizationSettings\n        {...this.props}\n        onEnableAllCurrencies={this.handleEnableAllCurrencies}\n        onEnableAllLanguages={this.handleEnableAllLanguages}\n        onUpdateCurrencyConfiguration={this.handleUpdateCurrencyConfiguration}\n        onUpdateLanguageConfiguration={this.handleUpdateLanguageConfiguration}\n        onUpdateLocalization={this.handleSubmit}\n      />\n    );\n  }\n}\n\nfunction composer(props, onData) {\n  const languages = [];\n  const shop = Shops.findOne();\n  const countries = Countries.find().fetch();\n  const preferences = Reaction.getUserPreferences(\"reaction-i18n\", \"settingsCards\", {});\n\n  if (typeof shop === \"object\" && shop.languages) {\n    for (const language of shop.languages) {\n      const i18nKey = \"languages.\" + language.label.toLowerCase();\n      languages.push({\n        label: language.label,\n        value: language.i18n,\n        enabled: (language.i18n === shop.language || language.enabled),\n        i18nKey: i18nKey\n      });\n    }\n  }\n\n  const currencies = shop.currencies;\n  const currencyList = [];\n  const currencyOptions = [];\n  for (const currency in currencies) {\n    if ({}.hasOwnProperty.call(currencies, currency)) {\n      if (currency === \"updatedAt\") {\n        continue;\n      }\n\n      const structure = currencies[currency];\n      const label = currency + \"  |  \" + structure.symbol + \"  |  \" +\n        structure.format;\n\n      currencyList.push({\n        name: currency,\n        label,\n        enabled: (structure.enabled || currency === shop.currency)\n      });\n\n      if (structure.enabled || currency === shop.currency) {\n        currencyOptions.push({\n          label,\n          value: currency\n        });\n      }\n    }\n  }\n\n\n  const unitsOfMeasure = Shops.findOne().unitsOfMeasure;\n  const uomOptions = [];\n  for (const measure of unitsOfMeasure) {\n    uomOptions.push({\n      label: i18next.t(`uom.${measure.uom}`, { defaultValue: measure.uom }),\n      value: measure.uom\n    });\n  }\n\n  const label = i18next.t(\"app.timezoneOptions\", \"Choose timezone\");\n  const timezoneOptions = [{\n    value: \"\",\n    label: label\n  }];\n  const timezones = moment.tz.names();\n  for (const timezone of timezones) {\n    timezoneOptions.push({\n      value: timezone,\n      label: timezone\n    });\n  }\n\n  onData(null, {\n    preferences,\n    shop,\n    languages,\n    currencies: currencyList,\n    enabledLanguages: languages.filter(language => (language.enabled || language.value === shop.language)),\n    countryOptions: countries,\n    currencyOptions,\n    uomOptions,\n    timezoneOptions\n  });\n}\n\nconst decoratedComponent = composeWithTracker(composer)(LocalizationSettingsContainer);\n\nexport default decoratedComponent;\n"]},"env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"generateLetDeclarations":true,"enforceStrictMode":false}],[[],null],[[],{"polyfill":false}],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":true,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"/imports/plugins/core/i18n/client/containers/localizationSettingsContainer.js.map","sourceFileName":"/imports/plugins/core/i18n/client/containers/localizationSettingsContainer.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"localizationSettingsContainer"},"ignored":false,"code":"var _typeof2 = require(\"babel-runtime/helpers/typeof\");\n\nvar _typeof3 = _interopRequireDefault(_typeof2);\n\nvar _extends2 = require(\"babel-runtime/helpers/extends\");\n\nvar _extends3 = _interopRequireDefault(_extends2);\n\nvar _classCallCheck2 = require(\"babel-runtime/helpers/classCallCheck\");\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _possibleConstructorReturn2 = require(\"babel-runtime/helpers/possibleConstructorReturn\");\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require(\"babel-runtime/helpers/inherits\");\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nvar React = void 0,\n    Component = void 0;\nmodule.importSync(\"react\", {\n  \"default\": function (v) {\n    React = v;\n  },\n  Component: function (v) {\n    Component = v;\n  }\n}, 0);\nvar Meteor = void 0;\nmodule.importSync(\"meteor/meteor\", {\n  Meteor: function (v) {\n    Meteor = v;\n  }\n}, 1);\nvar Reaction = void 0,\n    i18next = void 0;\nmodule.importSync(\"/client/api\", {\n  Reaction: function (v) {\n    Reaction = v;\n  },\n  i18next: function (v) {\n    i18next = v;\n  }\n}, 2);\nvar composeWithTracker = void 0;\nmodule.importSync(\"/lib/api/compose\", {\n  composeWithTracker: function (v) {\n    composeWithTracker = v;\n  }\n}, 3);\nvar Countries = void 0;\nmodule.importSync(\"/client/collections\", {\n  Countries: function (v) {\n    Countries = v;\n  }\n}, 4);\nvar Shops = void 0;\nmodule.importSync(\"/lib/collections\", {\n  Shops: function (v) {\n    Shops = v;\n  }\n}, 5);\nvar LocalizationSettings = void 0;\nmodule.importSync(\"../components/localizationSettings\", {\n  \"default\": function (v) {\n    LocalizationSettings = v;\n  }\n}, 6);\n\nvar LocalizationSettingsContainer = function (_Component) {\n  (0, _inherits3.default)(LocalizationSettingsContainer, _Component);\n\n  function LocalizationSettingsContainer() {\n    var _temp, _this, _ret;\n\n    (0, _classCallCheck3.default)(this, LocalizationSettingsContainer);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = (0, _possibleConstructorReturn3.default)(this, _Component.call.apply(_Component, [this].concat(args))), _this), _this.handleUpdateLanguageConfiguration = function (event, isChecked, name) {\n      var language = _this.props.languages.find(function (l) {\n        return l.value === name;\n      });\n\n      if (language) {\n        Meteor.call(\"shop/updateLanguageConfiguration\", language.value, isChecked);\n      }\n    }, _this.handleUpdateCurrencyConfiguration = function (event, isChecked, name) {\n      Meteor.call(\"shop/updateCurrencyConfiguration\", name, isChecked);\n    }, _this.handleSubmit = function (doc) {\n      Shops.update({\n        _id: doc._id\n      }, {\n        $set: {\n          timezone: doc.timezone,\n          currency: doc.currency,\n          baseUOM: doc.baseUOM,\n          language: doc.language\n        }\n      });\n    }, _this.handleEnableAllLanguages = function (isEnabled) {\n      Meteor.call(\"shop/updateLanguageConfiguration\", \"all\", isEnabled);\n    }, _this.handleEnableAllCurrencies = function (isEnabled) {\n      Meteor.call(\"shop/updateCurrencyConfiguration\", \"all\", isEnabled);\n    }, _temp), (0, _possibleConstructorReturn3.default)(_this, _ret);\n  }\n\n  LocalizationSettingsContainer.prototype.render = function () {\n    function render() {\n      return React.createElement(LocalizationSettings, (0, _extends3.default)({}, this.props, {\n        onEnableAllCurrencies: this.handleEnableAllCurrencies,\n        onEnableAllLanguages: this.handleEnableAllLanguages,\n        onUpdateCurrencyConfiguration: this.handleUpdateCurrencyConfiguration,\n        onUpdateLanguageConfiguration: this.handleUpdateLanguageConfiguration,\n        onUpdateLocalization: this.handleSubmit\n      }));\n    }\n\n    return render;\n  }();\n\n  return LocalizationSettingsContainer;\n}(Component);\n\nLocalizationSettingsContainer.propTypes = LocalizationSettings.propTypes;\n\nfunction composer(props, onData) {\n  var languages = [];\n  var shop = Shops.findOne();\n  var countries = Countries.find().fetch();\n  var preferences = Reaction.getUserPreferences(\"reaction-i18n\", \"settingsCards\", {});\n\n  if ((typeof shop === \"undefined\" ? \"undefined\" : (0, _typeof3.default)(shop)) === \"object\" && shop.languages) {\n    for (var _iterator = shop.languages, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {\n      var _ref;\n\n      if (_isArray) {\n        if (_i >= _iterator.length) break;\n        _ref = _iterator[_i++];\n      } else {\n        _i = _iterator.next();\n        if (_i.done) break;\n        _ref = _i.value;\n      }\n\n      var language = _ref;\n      var i18nKey = \"languages.\" + language.label.toLowerCase();\n      languages.push({\n        label: language.label,\n        value: language.i18n,\n        enabled: language.i18n === shop.language || language.enabled,\n        i18nKey: i18nKey\n      });\n    }\n  }\n\n  var currencies = shop.currencies;\n  var currencyList = [];\n  var currencyOptions = [];\n\n  for (var currency in meteorBabelHelpers.sanitizeForInObject(currencies)) {\n    if ({}.hasOwnProperty.call(currencies, currency)) {\n      if (currency === \"updatedAt\") {\n        continue;\n      }\n\n      var structure = currencies[currency];\n\n      var _label = currency + \"  |  \" + structure.symbol + \"  |  \" + structure.format;\n\n      currencyList.push({\n        name: currency,\n        label: _label,\n        enabled: structure.enabled || currency === shop.currency\n      });\n\n      if (structure.enabled || currency === shop.currency) {\n        currencyOptions.push({\n          label: _label,\n          value: currency\n        });\n      }\n    }\n  }\n\n  var unitsOfMeasure = Shops.findOne().unitsOfMeasure;\n  var uomOptions = [];\n\n  for (var _iterator2 = unitsOfMeasure, _isArray2 = Array.isArray(_iterator2), _i2 = 0, _iterator2 = _isArray2 ? _iterator2 : _iterator2[Symbol.iterator]();;) {\n    var _ref2;\n\n    if (_isArray2) {\n      if (_i2 >= _iterator2.length) break;\n      _ref2 = _iterator2[_i2++];\n    } else {\n      _i2 = _iterator2.next();\n      if (_i2.done) break;\n      _ref2 = _i2.value;\n    }\n\n    var measure = _ref2;\n    uomOptions.push({\n      label: i18next.t(\"uom.\" + measure.uom, {\n        defaultValue: measure.uom\n      }),\n      value: measure.uom\n    });\n  }\n\n  var label = i18next.t(\"app.timezoneOptions\", \"Choose timezone\");\n  var timezoneOptions = [{\n    value: \"\",\n    label: label\n  }];\n  var timezones = moment.tz.names();\n\n  for (var _iterator3 = timezones, _isArray3 = Array.isArray(_iterator3), _i3 = 0, _iterator3 = _isArray3 ? _iterator3 : _iterator3[Symbol.iterator]();;) {\n    var _ref3;\n\n    if (_isArray3) {\n      if (_i3 >= _iterator3.length) break;\n      _ref3 = _iterator3[_i3++];\n    } else {\n      _i3 = _iterator3.next();\n      if (_i3.done) break;\n      _ref3 = _i3.value;\n    }\n\n    var timezone = _ref3;\n    timezoneOptions.push({\n      value: timezone,\n      label: timezone\n    });\n  }\n\n  onData(null, {\n    preferences: preferences,\n    shop: shop,\n    languages: languages,\n    currencies: currencyList,\n    enabledLanguages: languages.filter(function (language) {\n      return language.enabled || language.value === shop.language;\n    }),\n    countryOptions: countries,\n    currencyOptions: currencyOptions,\n    uomOptions: uomOptions,\n    timezoneOptions: timezoneOptions\n  });\n}\n\nvar decoratedComponent = composeWithTracker(composer)(LocalizationSettingsContainer);\nmodule.export(\"default\", exports.default = decoratedComponent);","map":{"version":3,"sources":["/imports/plugins/core/i18n/client/containers/localizationSettingsContainer.js"],"names":["React","Component","Meteor","Reaction","i18next","composeWithTracker","Countries","Shops","LocalizationSettings","LocalizationSettingsContainer","propTypes","handleUpdateLanguageConfiguration","event","isChecked","name","language","props","languages","find","l","value","call","handleUpdateCurrencyConfiguration","handleSubmit","doc","update","_id","$set","timezone","currency","baseUOM","handleEnableAllLanguages","isEnabled","handleEnableAllCurrencies","render","composer","onData","shop","findOne","countries","fetch","preferences","getUserPreferences","i18nKey","label","toLowerCase","push","i18n","enabled","currencies","currencyList","currencyOptions","hasOwnProperty","structure","symbol","format","unitsOfMeasure","uomOptions","measure","t","uom","defaultValue","timezoneOptions","timezones","moment","tz","names","enabledLanguages","filter","countryOptions","decoratedComponent"],"mappings":"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","file":"/imports/plugins/core/i18n/client/containers/localizationSettingsContainer.js.map","sourcesContent":["import React, { Component } from \"react\";\nimport { Meteor } from \"meteor/meteor\";\nimport { Reaction, i18next } from \"/client/api\";\nimport { composeWithTracker } from \"/lib/api/compose\";\nimport { Countries } from \"/client/collections\";\nimport { Shops } from \"/lib/collections\";\nimport LocalizationSettings from \"../components/localizationSettings\";\n\nclass LocalizationSettingsContainer extends Component {\n  static propTypes = LocalizationSettings.propTypes\n\n  handleUpdateLanguageConfiguration = (event, isChecked, name) => {\n    const language = this.props.languages.find((l) => l.value === name);\n\n    if (language) {\n      Meteor.call(\"shop/updateLanguageConfiguration\", language.value, isChecked);\n    }\n  }\n\n  handleUpdateCurrencyConfiguration = (event, isChecked, name) => {\n    Meteor.call(\"shop/updateCurrencyConfiguration\", name, isChecked);\n  }\n\n  handleSubmit = (doc) => {\n    Shops.update({\n      _id: doc._id\n    }, {\n      $set: {\n        timezone: doc.timezone,\n        currency: doc.currency,\n        baseUOM: doc.baseUOM,\n        language: doc.language\n      }\n    });\n  }\n\n  handleEnableAllLanguages = (isEnabled) => {\n    Meteor.call(\"shop/updateLanguageConfiguration\", \"all\", isEnabled);\n  }\n\n  handleEnableAllCurrencies = (isEnabled) => {\n    Meteor.call(\"shop/updateCurrencyConfiguration\", \"all\", isEnabled);\n  }\n\n  render() {\n    return (\n      <LocalizationSettings\n        {...this.props}\n        onEnableAllCurrencies={this.handleEnableAllCurrencies}\n        onEnableAllLanguages={this.handleEnableAllLanguages}\n        onUpdateCurrencyConfiguration={this.handleUpdateCurrencyConfiguration}\n        onUpdateLanguageConfiguration={this.handleUpdateLanguageConfiguration}\n        onUpdateLocalization={this.handleSubmit}\n      />\n    );\n  }\n}\n\nfunction composer(props, onData) {\n  const languages = [];\n  const shop = Shops.findOne();\n  const countries = Countries.find().fetch();\n  const preferences = Reaction.getUserPreferences(\"reaction-i18n\", \"settingsCards\", {});\n\n  if (typeof shop === \"object\" && shop.languages) {\n    for (const language of shop.languages) {\n      const i18nKey = \"languages.\" + language.label.toLowerCase();\n      languages.push({\n        label: language.label,\n        value: language.i18n,\n        enabled: (language.i18n === shop.language || language.enabled),\n        i18nKey: i18nKey\n      });\n    }\n  }\n\n  const currencies = shop.currencies;\n  const currencyList = [];\n  const currencyOptions = [];\n  for (const currency in currencies) {\n    if ({}.hasOwnProperty.call(currencies, currency)) {\n      if (currency === \"updatedAt\") {\n        continue;\n      }\n\n      const structure = currencies[currency];\n      const label = currency + \"  |  \" + structure.symbol + \"  |  \" +\n        structure.format;\n\n      currencyList.push({\n        name: currency,\n        label,\n        enabled: (structure.enabled || currency === shop.currency)\n      });\n\n      if (structure.enabled || currency === shop.currency) {\n        currencyOptions.push({\n          label,\n          value: currency\n        });\n      }\n    }\n  }\n\n\n  const unitsOfMeasure = Shops.findOne().unitsOfMeasure;\n  const uomOptions = [];\n  for (const measure of unitsOfMeasure) {\n    uomOptions.push({\n      label: i18next.t(`uom.${measure.uom}`, { defaultValue: measure.uom }),\n      value: measure.uom\n    });\n  }\n\n  const label = i18next.t(\"app.timezoneOptions\", \"Choose timezone\");\n  const timezoneOptions = [{\n    value: \"\",\n    label: label\n  }];\n  const timezones = moment.tz.names();\n  for (const timezone of timezones) {\n    timezoneOptions.push({\n      value: timezone,\n      label: timezone\n    });\n  }\n\n  onData(null, {\n    preferences,\n    shop,\n    languages,\n    currencies: currencyList,\n    enabledLanguages: languages.filter(language => (language.enabled || language.value === shop.language)),\n    countryOptions: countries,\n    currencyOptions,\n    uomOptions,\n    timezoneOptions\n  });\n}\n\nconst decoratedComponent = composeWithTracker(composer)(LocalizationSettingsContainer);\n\nexport default decoratedComponent;\n"]},"hash":"bd266ed1f2ee46da684f9def914a4423d9db2774"}
