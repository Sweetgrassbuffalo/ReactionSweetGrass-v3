{"metadata":{"usedHelpers":["typeof","interopRequireDefault"],"marked":[],"modules":{"imports":[{"source":"/client/api","imported":["Reaction"],"specifiers":[{"kind":"named","imported":"Reaction","local":"Reaction"}]},{"source":"/lib/collections","imported":["Shops"],"specifiers":[{"kind":"named","imported":"Shops","local":"Shops"}]}],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"/client/modules/i18n/templates/header/i18n.js","filenameRelative":"/client/modules/i18n/templates/header/i18n.js","inputSourceMap":{"version":3,"sources":["/client/modules/i18n/templates/header/i18n.js"],"names":["Reaction","Shops","Template","i18nChooser","helpers","languages","Subscriptions","ready","Meteor","user","shop","findOne","language","enabled","translation","label","toLowerCase","profile","lang","i18n","class","push","length","events","event","preventDefault","users","update","userId","$set"],"mappings":";;;;;;AAAA,IAAS;AAAT,OAAyB,WAAzB;;;;;;;;;;GACA,A,AAAA,AAAS,AAAa,AACtB;AAIA,AAAS,AAAY,AAAQ,AAC3B,AAAY;;YACJ,YAAN,AAAkB;yBAClB;AAAI,QAAS,YAAb,AAAI,AAAuB,AAAM,AAAW,AAAO,AAAQ,AACzD;;QAAM,SAAO,AAAM,cAAnB,AAAa;uBACb;;UAAI,QAAA,AAAO,sEAAP,AAAgB,YAAY,KAAhC,AAAqC,WAAW,AAC9C;AAAK,6BAAkB,KAAvB,AAA4B;AAAW,AACrC;;;;;;;;;;;cADF,AAAW;;cACL,SAAA,AAAS,YAAb,AAAyB,MAAM,AAC7B;qBAAA,AAAS,cAAc,eAAe,SAAA,AAAS,MADlB,AAC7B,AAAsC,AAAe,AACrD,AACA;AACA;;gBAAM,UAAU,OAAA,AAAO,OAAvB,AAA8B;;yCAC9B;AAAI,0BAAW,SAAf,AAAuB,AAAM,eAC3B;AAAI,yBAAA,AAAQ,QAAZ,AAAqB,AAAS,AAAM,AAClC;AAAA,AAAS,AAAQ,AAClB;wDAHH,AAIC;AAAM,AAAI,AAAK,AAAa,AAAS,AAAM,AAC1C;AACA;+BACA;AAAA,AAAS,AAAQ,AAClB;;;AACD;AAAA,AAAU,AAAK,AAChB;;kCACF;;AACD;AAAA,AAAI,AAAU,AAAS,AAAG,AACxB;AAAA,AAAO,AACR;;8BACF;aACF;;AACD,AAAI,AAAU,AAAS,AAAG,AACxB,AAAO;CA5BT,GAFJ,AA+BK,A,AA/BwB,AAgC1B,AAGH;;;;;AAIS,UAAT,AAAqB,AAAO,AAC1B,iBADF,CACE,AAAuB,AAAO,AAC5B;AAD4B,AAC5B,AAAM,AACN,AACA;AACA;AACA;AACA;;;;;;;AAPJ,AAA4B,AAQxB,AAAO,AAAM,AAAO,AAAO,AAAU,AAAE,AAAM,AAAE,AAAgB,AAAK,AACrE","file":"/client/modules/i18n/templates/header/i18n.js.map","sourcesContent":["import { Reaction } from \"/client/api\";\nimport { Shops } from \"/lib/collections\";\n/**\n * i18nChooser helpers\n */\n\nTemplate.i18nChooser.helpers({\n  languages() {\n    const languages = [];\n    if (Reaction.Subscriptions.Shops.ready() && Meteor.user()) {\n      const shop = Shops.findOne();\n      if (typeof shop === \"object\" && shop.languages) {\n        for (const language of shop.languages) {\n          if (language.enabled === true) {\n            language.translation = \"languages.\" + language.label.toLowerCase();\n            // appending a helper to let us know this\n            // language is currently selected\n            const profile = Meteor.user().profile;\n            if (profile && profile.lang) {\n              if (profile.lang === language.i18n) {\n                language.class = \"active\";\n              }\n            } else if (shop.language === language.i18n) {\n              // we don't have a profile language\n              // use the shop default\n              language.class = \"active\";\n            }\n            languages.push(language);\n          }\n        }\n        if (languages.length > 1) {\n          return languages;\n        }\n      }\n    }\n    if (languages.length > 1) {\n      return languages;\n    }\n  }\n});\n\n/**\n * i18nChooser events\n */\n\nTemplate.i18nChooser.events({\n  \"click .i18n-language\"(event) {\n    event.preventDefault();\n    //\n    // this is a sanctioned use of Meteor.user.update\n    // and only possible because we allow it in the\n    // UserProfile and ShopMembers publications.\n    //\n    Meteor.users.update(Meteor.userId(), { $set: { \"profile.lang\": this.i18n } });\n  }\n});\n"]},"env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"generateLetDeclarations":true,"enforceStrictMode":false}],[[],null],[[],{"polyfill":false}],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":true,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"/client/modules/i18n/templates/header/i18n.js.map","sourceFileName":"/client/modules/i18n/templates/header/i18n.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"i18n"},"ignored":false,"code":"var _typeof2 = require(\"babel-runtime/helpers/typeof\");\n\nvar _typeof3 = _interopRequireDefault(_typeof2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n\nvar Reaction = void 0;\nmodule.importSync(\"/client/api\", {\n  Reaction: function (v) {\n    Reaction = v;\n  }\n}, 0);\nvar Shops = void 0;\nmodule.importSync(\"/lib/collections\", {\n  Shops: function (v) {\n    Shops = v;\n  }\n}, 1);\n/**\n * i18nChooser helpers\n */Template.i18nChooser.helpers({\n  languages: function () {\n    var languages = [];\n\n    if (Reaction.Subscriptions.Shops.ready() && Meteor.user()) {\n      var shop = Shops.findOne();\n\n      if ((typeof shop === \"undefined\" ? \"undefined\" : (0, _typeof3.default)(shop)) === \"object\" && shop.languages) {\n        for (var _iterator = shop.languages, _isArray = Array.isArray(_iterator), _i = 0, _iterator = _isArray ? _iterator : _iterator[Symbol.iterator]();;) {\n          var _ref;\n\n          if (_isArray) {\n            if (_i >= _iterator.length) break;\n            _ref = _iterator[_i++];\n          } else {\n            _i = _iterator.next();\n            if (_i.done) break;\n            _ref = _i.value;\n          }\n\n          var language = _ref;\n\n          if (language.enabled === true) {\n            language.translation = \"languages.\" + language.label.toLowerCase(); // appending a helper to let us know this\n            // language is currently selected\n\n            var profile = Meteor.user().profile;\n\n            if (profile && profile.lang) {\n              if (profile.lang === language.i18n) {\n                language.class = \"active\";\n              }\n            } else if (shop.language === language.i18n) {\n              // we don't have a profile language\n              // use the shop default\n              language.class = \"active\";\n            }\n\n            languages.push(language);\n          }\n        }\n\n        if (languages.length > 1) {\n          return languages;\n        }\n      }\n    }\n\n    if (languages.length > 1) {\n      return languages;\n    }\n  }\n}); /**\n     * i18nChooser events\n     */\nTemplate.i18nChooser.events({\n  \"click .i18n-language\": function (event) {\n    event.preventDefault(); //\n    // this is a sanctioned use of Meteor.user.update\n    // and only possible because we allow it in the\n    // UserProfile and ShopMembers publications.\n    //\n\n    Meteor.users.update(Meteor.userId(), {\n      $set: {\n        \"profile.lang\": this.i18n\n      }\n    });\n  }\n});","map":{"version":3,"sources":["/client/modules/i18n/templates/header/i18n.js"],"names":["Reaction","Shops","Template","i18nChooser","helpers","languages","Subscriptions","ready","Meteor","user","shop","findOne","language","enabled","translation","label","toLowerCase","profile","lang","i18n","class","push","length","events","event","preventDefault","users","update","userId","$set"],"mappings":";;;;;;AAAA,IAAS;AAAT,OAAyB,WAAzB;;;;;;;;;;GACA,A,AAAA,AAAS,AAAa,AACtB;AAIA,AAAS,AAAY,AAAQ,AAC3B,AAAY;;YACJ,YAAN,AAAkB;yBAClB;AAAI,QAAS,YAAb,AAAI,AAAuB,AAAM,AAAW,AAAO,AAAQ,AACzD;;QAAM,SAAO,AAAM,cAAnB,AAAa;uBACb;;UAAI,QAAA,AAAO,sEAAP,AAAgB,YAAY,KAAhC,AAAqC,WAAW,AAC9C;AAAK,6BAAkB,KAAvB,AAA4B;AAAW,AACrC;;;;;;;;;;;cADF,AAAW;;cACL,SAAA,AAAS,YAAb,AAAyB,MAAM,AAC7B;qBAAA,AAAS,cAAc,eAAe,SAAA,AAAS,MADlB,AAC7B,AAAsC,AAAe,AACrD,AACA;AACA;;gBAAM,UAAU,OAAA,AAAO,OAAvB,AAA8B;;yCAC9B;AAAI,0BAAW,SAAf,AAAuB,AAAM,eAC3B;AAAI,yBAAA,AAAQ,QAAZ,AAAqB,AAAS,AAAM,AAClC;AAAA,AAAS,AAAQ,AAClB;wDAHH,AAIC;AAAM,AAAI,AAAK,AAAa,AAAS,AAAM,AAC1C;AACA;+BACA;AAAA,AAAS,AAAQ,AAClB;;;AACD;AAAA,AAAU,AAAK,AAChB;;kCACF;;AACD;AAAA,AAAI,AAAU,AAAS,AAAG,AACxB;AAAA,AAAO,AACR;;8BACF;aACF;;AACD,AAAI,AAAU,AAAS,AAAG,AACxB,AAAO;CA5BT,GAFJ,AA+BK,A,AA/BwB,AAgC1B,AAGH;;;;;AAIS,UAAT,AAAqB,AAAO,AAC1B,iBADF,CACE,AAAuB,AAAO,AAC5B;AAD4B,AAC5B,AAAM,AACN,AACA;AACA;AACA;AACA;;;;;;;AAPJ,AAA4B,AAQxB,AAAO,AAAM,AAAO,AAAO,AAAU,AAAE,AAAM,AAAE,AAAgB,AAAK,AACrE","file":"/client/modules/i18n/templates/header/i18n.js.map","sourcesContent":["import { Reaction } from \"/client/api\";\nimport { Shops } from \"/lib/collections\";\n/**\n * i18nChooser helpers\n */\n\nTemplate.i18nChooser.helpers({\n  languages() {\n    const languages = [];\n    if (Reaction.Subscriptions.Shops.ready() && Meteor.user()) {\n      const shop = Shops.findOne();\n      if (typeof shop === \"object\" && shop.languages) {\n        for (const language of shop.languages) {\n          if (language.enabled === true) {\n            language.translation = \"languages.\" + language.label.toLowerCase();\n            // appending a helper to let us know this\n            // language is currently selected\n            const profile = Meteor.user().profile;\n            if (profile && profile.lang) {\n              if (profile.lang === language.i18n) {\n                language.class = \"active\";\n              }\n            } else if (shop.language === language.i18n) {\n              // we don't have a profile language\n              // use the shop default\n              language.class = \"active\";\n            }\n            languages.push(language);\n          }\n        }\n        if (languages.length > 1) {\n          return languages;\n        }\n      }\n    }\n    if (languages.length > 1) {\n      return languages;\n    }\n  }\n});\n\n/**\n * i18nChooser events\n */\n\nTemplate.i18nChooser.events({\n  \"click .i18n-language\"(event) {\n    event.preventDefault();\n    //\n    // this is a sanctioned use of Meteor.user.update\n    // and only possible because we allow it in the\n    // UserProfile and ShopMembers publications.\n    //\n    Meteor.users.update(Meteor.userId(), { $set: { \"profile.lang\": this.i18n } });\n  }\n});\n"]},"hash":"c276d6934e1e17a5728b7c352a33140d73c428af"}
