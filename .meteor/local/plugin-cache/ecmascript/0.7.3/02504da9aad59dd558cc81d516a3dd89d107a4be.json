{"metadata":{"usedHelpers":[],"marked":[],"modules":{"imports":[{"source":"meteor/meteor","imported":["Meteor"],"specifiers":[{"kind":"named","imported":"Meteor","local":"Meteor"}]},{"source":"meteor/reactive-dict","imported":["ReactiveDict"],"specifiers":[{"kind":"named","imported":"ReactiveDict","local":"ReactiveDict"}]},{"source":"meteor/session","imported":["Session"],"specifiers":[{"kind":"named","imported":"Session","local":"Session"}]},{"source":"meteor/templating","imported":["Template"],"specifiers":[{"kind":"named","imported":"Template","local":"Template"}]},{"source":"/client/api","imported":["Reaction","i18next"],"specifiers":[{"kind":"named","imported":"Reaction","local":"Reaction"},{"kind":"named","imported":"i18next","local":"i18next"}]},{"source":"/lib/api","imported":["ReactionProduct"],"specifiers":[{"kind":"named","imported":"ReactionProduct","local":"ReactionProduct"}]},{"source":"/lib/api/products","imported":["applyProductRevision"],"specifiers":[{"kind":"named","imported":"applyProductRevision","local":"applyProductRevision"}]},{"source":"/lib/collections","imported":["Products"],"specifiers":[{"kind":"named","imported":"Products","local":"Products"}]},{"source":"../../../../../containers/variantFormContainer","imported":["default"],"specifiers":[{"kind":"named","imported":"default","local":"VariantFormContainer"}]}],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"/imports/plugins/included/product-variant/client/templates/products/productDetail/variants/variantForm/variantForm.js","filenameRelative":"/imports/plugins/included/product-variant/client/templates/products/productDetail/variants/variantForm/variantForm.js","inputSourceMap":{"version":3,"sources":["/imports/plugins/included/product-variant/client/templates/products/productDetail/variants/variantForm/variantForm.js"],"names":["Meteor","ReactiveDict","Session","Template","Reaction","i18next","ReactionProduct","applyProductRevision","Products","VariantFormContainer","variantForm","onCreated","state","autorun","productHandle","Router","getParam","clearActionView","getVariant","variant","product","findOne","_id","helpers","variantFormComponent","instance","data","childVariants","variants","getVariants","map","ancestors","indexOf","type","push","variantFormId","events","event","template","stopPropagation","preventDefault","productId","selectedProductId","call","error","result","Alerts","alert","text","t","title","confirmButtonText","defaultValue","newVariantId","selectedProduct","handle","__published","setCurrentVariant","set","go","variantId"],"mappings":"AAAA,IAAS;AAAT,OAAuB,WAAvB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;GACA,AAAS,AAAoB,AAC7B,AAAS,AAAe,AACxB,AAAS,AAAgB,AACzB,AAAS,AAAU,AAAe,AAClC,AAAS,AAAuB,AAChC,AAAS,AAA4B,AACrC,AAAS,AAAgB,AACzB,AAAO,AAA0B,AAEjC,AAAS,AAAY,AAAU,AAAY;AACzC,AAAK,SAAL,AAAa,AAAI,sBAAjB,AAAa,YAEb;OAAA,AAAK,QAAQ,IAAM,AACjB,AAAM,AAAgB,AAAS,AAAO,AAAS;2BAE/C;AAAI,AAAC,QAAL,AAAoB,yCAClB,AAAS,AACV;;wBALH,AAMC;;AAED;AAAA,AAAK,AAAa,AAAC,AAAY,AAC7B,AAAM,AAAU,AAAS,AAAQ,AAAQ,AACzC;;OAAO,uBAAqB,SAF9B,AAEE,AAAO,AACR;2C,AAdH,AAeC;AAED;;AAIA,AAAS,AAAY,AAAQ,IAAA,AAC3B,AAAuB,AACrB,AAAO,AACR;;;AACD,SAAU;AACF,AAAW,oCAAjB,AAAiB,AAAS,AAC1B;WAAA,AAAO,AAAS,AAAW,AAAS,AACrC;AAP0B;uBAQ3B;QAAe,WAAY,SACzB;AAAM,WAAM,SAAZ,AAAiB,oBACjB;AAAA,AAAM,AAAW,AAAgB,AACjC;AAAM,iBAAN,AAAsB,YACtB;QAAS,MAAT,AAAa,KAAW,AACtB;QAAI,AAAC,AAAQ,WAAR,AAAkB,gBAAvB,AAAI,AAAC,AAA0B,AAAQ,AAAQ,AAAS,AAAa,AACnE;QAAc,gBAAd,AAAmB,AACpB;oCAHH,AAIC;2EACD;AAAO,sBAAP,KAjByB,AAkB1B;AACD;AAAe,AAAY,AACzB;WAAA,AAAO,AAAkB,AAAK,AAC/B;AArBH,AAA6B;A,AAwB7B;;AAIA,AAAS,AAAY,AAAO,AAC1B,AAAiC,AAAU,AAAO,AAAU;AAxB1D,IAyBA,AAAM,AACN,AAAM,AACN,AAAM,AAAY,AAAgB;;;AAElC,AAAI,SAAJ,AAAK,AAAW;8DAEf;;UAED;QAAA,AAAO,AAAK,4BAAZ,AAAsC,AAAS,AAAK,AAAK,AAAU,AAAO,AAAQ,AAChF,AAAI,AAAO,AACT;;SAAO,WAAP,AAAa,AACX;AAAM,AAAQ,AAAE,AAAoC,AAAE;AAD3C,AACL,AAA8C,AAAS,AAAS,AAAK,AAC3E;;gBAAmB,AAAQ,AAAE,0BAAV,SAAuB,mCAAE;iBAAF,AAAgB;AAAvC;;iCAHvB,AAKC;;AAAM,AAAI,AAAQ;0BACjB,AAAM,AAAe,AACrB;;AANA,AAAa;aAMP,YAAN,AAAwB,AAAgB,AACxC;YAAM,AAAS,eAAf,AAAe,AAAgB,AAAe,AAAgB,AAAY,AAAU,AAAgB,AACpG;YAAgB,kBAAhB,AAAkC,gBAAlC,AACA;YAAA,AAAQ,AAAI,SAAkB,gBAA9B,AAA4C,eAA5C,sDAEA;AAAA,AAAS,wBAAT,AAAgB,AAAG,AAAW,kBAC5B;gBAAQ,IADoB,gCAAA,AAE5B,AAAW;AAFb;kBAbJ,AAkBC;qBA5BL,AAA4B,AA6BzB;AAFI;;;;AApBD","file":"/imports/plugins/included/product-variant/client/templates/products/productDetail/variants/variantForm/variantForm.js.map","sourcesContent":["import { Meteor } from \"meteor/meteor\";\nimport { ReactiveDict } from \"meteor/reactive-dict\";\nimport { Session } from \"meteor/session\";\nimport { Template } from \"meteor/templating\";\nimport { Reaction, i18next } from \"/client/api\";\nimport { ReactionProduct } from \"/lib/api\";\nimport { applyProductRevision } from \"/lib/api/products\";\nimport { Products } from \"/lib/collections\";\nimport VariantFormContainer from \"../../../../../containers/variantFormContainer\";\n\nTemplate.variantForm.onCreated(function () {\n  this.state = new ReactiveDict();\n\n  this.autorun(() => {\n    const productHandle = Reaction.Router.getParam(\"handle\");\n\n    if (!productHandle) {\n      Reaction.clearActionView();\n    }\n  });\n\n  this.getVariant = (variant) => {\n    const product = Products.findOne(variant._id);\n    return applyProductRevision(product);\n  };\n});\n\n/**\n * variantForm helpers\n */\n\nTemplate.variantForm.helpers({\n  variantFormComponent() {\n    return VariantFormContainer;\n  },\n  variant() {\n    const instance = Template.instance();\n    return instance.getVariant(instance.data);\n  },\n  childVariants: function () {\n    const _id = this._id;\n    const variants = ReactionProduct.getVariants();\n    const childVariants = [];\n    variants.map(variant => {\n      if (~variant.ancestors.indexOf(_id) && variant.type !== \"inventory\") {\n        childVariants.push(variant);\n      }\n    });\n    return childVariants;\n  },\n  variantFormId: function () {\n    return \"variant-form-\" + this._id;\n  }\n});\n\n/**\n * variantForm events\n */\n\nTemplate.variantForm.events({\n  \"click .btn-child-variant-form\": function (event, template) {\n    event.stopPropagation();\n    event.preventDefault();\n    const productId = ReactionProduct.selectedProductId();\n\n    if (!productId) {\n      return;\n    }\n\n    Meteor.call(\"products/createVariant\", template.data._id, function (error, result) {\n      if (error) {\n        Alerts.alert({\n          text: i18next.t(\"productDetailEdit.addVariantFail\", { title: template.data.title }),\n          confirmButtonText: i18next.t(\"app.close\", { defaultValue: \"Close\" })\n        });\n      } else if (result) {\n        const newVariantId = result;\n        const selectedProduct = ReactionProduct.selectedProduct();\n        const handle = selectedProduct.__published && selectedProduct.__published.handle || selectedProduct.handle;\n        ReactionProduct.setCurrentVariant(newVariantId);\n        Session.set(\"variant-form-\" + newVariantId, true);\n\n        Reaction.Router.go(\"product\", {\n          handle: handle,\n          variantId: newVariantId\n        });\n      }\n    });\n  }\n});\n"]},"env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"generateLetDeclarations":true,"enforceStrictMode":false}],[[],null],[[],{"polyfill":false}],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":true,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"/imports/plugins/included/product-variant/client/templates/products/productDetail/variants/variantForm/variantForm.js.map","sourceFileName":"/imports/plugins/included/product-variant/client/templates/products/productDetail/variants/variantForm/variantForm.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"variantForm"},"ignored":false,"code":"var Meteor = void 0;\nmodule.importSync(\"meteor/meteor\", {\n  Meteor: function (v) {\n    Meteor = v;\n  }\n}, 0);\nvar ReactiveDict = void 0;\nmodule.importSync(\"meteor/reactive-dict\", {\n  ReactiveDict: function (v) {\n    ReactiveDict = v;\n  }\n}, 1);\nvar Session = void 0;\nmodule.importSync(\"meteor/session\", {\n  Session: function (v) {\n    Session = v;\n  }\n}, 2);\nvar Template = void 0;\nmodule.importSync(\"meteor/templating\", {\n  Template: function (v) {\n    Template = v;\n  }\n}, 3);\nvar Reaction = void 0,\n    i18next = void 0;\nmodule.importSync(\"/client/api\", {\n  Reaction: function (v) {\n    Reaction = v;\n  },\n  i18next: function (v) {\n    i18next = v;\n  }\n}, 4);\nvar ReactionProduct = void 0;\nmodule.importSync(\"/lib/api\", {\n  ReactionProduct: function (v) {\n    ReactionProduct = v;\n  }\n}, 5);\nvar applyProductRevision = void 0;\nmodule.importSync(\"/lib/api/products\", {\n  applyProductRevision: function (v) {\n    applyProductRevision = v;\n  }\n}, 6);\nvar Products = void 0;\nmodule.importSync(\"/lib/collections\", {\n  Products: function (v) {\n    Products = v;\n  }\n}, 7);\nvar VariantFormContainer = void 0;\nmodule.importSync(\"../../../../../containers/variantFormContainer\", {\n  \"default\": function (v) {\n    VariantFormContainer = v;\n  }\n}, 8);\nTemplate.variantForm.onCreated(function () {\n  this.state = new ReactiveDict();\n  this.autorun(function () {\n    var productHandle = Reaction.Router.getParam(\"handle\");\n\n    if (!productHandle) {\n      Reaction.clearActionView();\n    }\n  });\n\n  this.getVariant = function (variant) {\n    var product = Products.findOne(variant._id);\n    return applyProductRevision(product);\n  };\n}); /**\n     * variantForm helpers\n     */\nTemplate.variantForm.helpers({\n  variantFormComponent: function () {\n    return VariantFormContainer;\n  },\n  variant: function () {\n    var instance = Template.instance();\n    return instance.getVariant(instance.data);\n  },\n  childVariants: function () {\n    var _id = this._id;\n    var variants = ReactionProduct.getVariants();\n    var childVariants = [];\n    variants.map(function (variant) {\n      if (~variant.ancestors.indexOf(_id) && variant.type !== \"inventory\") {\n        childVariants.push(variant);\n      }\n    });\n    return childVariants;\n  },\n  variantFormId: function () {\n    return \"variant-form-\" + this._id;\n  }\n}); /**\n     * variantForm events\n     */\nTemplate.variantForm.events({\n  \"click .btn-child-variant-form\": function (event, template) {\n    event.stopPropagation();\n    event.preventDefault();\n    var productId = ReactionProduct.selectedProductId();\n\n    if (!productId) {\n      return;\n    }\n\n    Meteor.call(\"products/createVariant\", template.data._id, function (error, result) {\n      if (error) {\n        Alerts.alert({\n          text: i18next.t(\"productDetailEdit.addVariantFail\", {\n            title: template.data.title\n          }),\n          confirmButtonText: i18next.t(\"app.close\", {\n            defaultValue: \"Close\"\n          })\n        });\n      } else if (result) {\n        var newVariantId = result;\n        var selectedProduct = ReactionProduct.selectedProduct();\n        var handle = selectedProduct.__published && selectedProduct.__published.handle || selectedProduct.handle;\n        ReactionProduct.setCurrentVariant(newVariantId);\n        Session.set(\"variant-form-\" + newVariantId, true);\n        Reaction.Router.go(\"product\", {\n          handle: handle,\n          variantId: newVariantId\n        });\n      }\n    });\n  }\n});","map":{"version":3,"sources":["/imports/plugins/included/product-variant/client/templates/products/productDetail/variants/variantForm/variantForm.js"],"names":["Meteor","ReactiveDict","Session","Template","Reaction","i18next","ReactionProduct","applyProductRevision","Products","VariantFormContainer","variantForm","onCreated","state","autorun","productHandle","Router","getParam","clearActionView","getVariant","variant","product","findOne","_id","helpers","variantFormComponent","instance","data","childVariants","variants","getVariants","map","ancestors","indexOf","type","push","variantFormId","events","event","template","stopPropagation","preventDefault","productId","selectedProductId","call","error","result","Alerts","alert","text","t","title","confirmButtonText","defaultValue","newVariantId","selectedProduct","handle","__published","setCurrentVariant","set","go","variantId"],"mappings":"AAAA,IAAS;AAAT,OAAuB,WAAvB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;GACA,AAAS,AAAoB,AAC7B,AAAS,AAAe,AACxB,AAAS,AAAgB,AACzB,AAAS,AAAU,AAAe,AAClC,AAAS,AAAuB,AAChC,AAAS,AAA4B,AACrC,AAAS,AAAgB,AACzB,AAAO,AAA0B,AAEjC,AAAS,AAAY,AAAU,AAAY;AACzC,AAAK,SAAL,AAAa,AAAI,sBAAjB,AAAa,YAEb;OAAA,AAAK,QAAQ,IAAM,AACjB,AAAM,AAAgB,AAAS,AAAO,AAAS;2BAE/C;AAAI,AAAC,QAAL,AAAoB,yCAClB,AAAS,AACV;;wBALH,AAMC;;AAED;AAAA,AAAK,AAAa,AAAC,AAAY,AAC7B,AAAM,AAAU,AAAS,AAAQ,AAAQ,AACzC;;OAAO,uBAAqB,SAF9B,AAEE,AAAO,AACR;2C,AAdH,AAeC;AAED;;AAIA,AAAS,AAAY,AAAQ,IAAA,AAC3B,AAAuB,AACrB,AAAO,AACR;;;AACD,SAAU;AACF,AAAW,oCAAjB,AAAiB,AAAS,AAC1B;WAAA,AAAO,AAAS,AAAW,AAAS,AACrC;AAP0B;uBAQ3B;QAAe,WAAY,SACzB;AAAM,WAAM,SAAZ,AAAiB,oBACjB;AAAA,AAAM,AAAW,AAAgB,AACjC;AAAM,iBAAN,AAAsB,YACtB;QAAS,MAAT,AAAa,KAAW,AACtB;QAAI,AAAC,AAAQ,WAAR,AAAkB,gBAAvB,AAAI,AAAC,AAA0B,AAAQ,AAAQ,AAAS,AAAa,AACnE;QAAc,gBAAd,AAAmB,AACpB;oCAHH,AAIC;2EACD;AAAO,sBAAP,KAjByB,AAkB1B;AACD;AAAe,AAAY,AACzB;WAAA,AAAO,AAAkB,AAAK,AAC/B;AArBH,AAA6B;A,AAwB7B;;AAIA,AAAS,AAAY,AAAO,AAC1B,AAAiC,AAAU,AAAO,AAAU;AAxB1D,IAyBA,AAAM,AACN,AAAM,AACN,AAAM,AAAY,AAAgB;;;AAElC,AAAI,SAAJ,AAAK,AAAW;8DAEf;;UAED;QAAA,AAAO,AAAK,4BAAZ,AAAsC,AAAS,AAAK,AAAK,AAAU,AAAO,AAAQ,AAChF,AAAI,AAAO,AACT;;SAAO,WAAP,AAAa,AACX;AAAM,AAAQ,AAAE,AAAoC,AAAE;AAD3C,AACL,AAA8C,AAAS,AAAS,AAAK,AAC3E;;gBAAmB,AAAQ,AAAE,0BAAV,SAAuB,mCAAE;iBAAF,AAAgB;AAAvC;;iCAHvB,AAKC;;AAAM,AAAI,AAAQ;0BACjB,AAAM,AAAe,AACrB;;AANA,AAAa;aAMP,YAAN,AAAwB,AAAgB,AACxC;YAAM,AAAS,eAAf,AAAe,AAAgB,AAAe,AAAgB,AAAY,AAAU,AAAgB,AACpG;YAAgB,kBAAhB,AAAkC,gBAAlC,AACA;YAAA,AAAQ,AAAI,SAAkB,gBAA9B,AAA4C,eAA5C,sDAEA;AAAA,AAAS,wBAAT,AAAgB,AAAG,AAAW,kBAC5B;gBAAQ,IADoB,gCAAA,AAE5B,AAAW;AAFb;kBAbJ,AAkBC;qBA5BL,AAA4B,AA6BzB;AAFI;;;;AApBD","file":"/imports/plugins/included/product-variant/client/templates/products/productDetail/variants/variantForm/variantForm.js.map","sourcesContent":["import { Meteor } from \"meteor/meteor\";\nimport { ReactiveDict } from \"meteor/reactive-dict\";\nimport { Session } from \"meteor/session\";\nimport { Template } from \"meteor/templating\";\nimport { Reaction, i18next } from \"/client/api\";\nimport { ReactionProduct } from \"/lib/api\";\nimport { applyProductRevision } from \"/lib/api/products\";\nimport { Products } from \"/lib/collections\";\nimport VariantFormContainer from \"../../../../../containers/variantFormContainer\";\n\nTemplate.variantForm.onCreated(function () {\n  this.state = new ReactiveDict();\n\n  this.autorun(() => {\n    const productHandle = Reaction.Router.getParam(\"handle\");\n\n    if (!productHandle) {\n      Reaction.clearActionView();\n    }\n  });\n\n  this.getVariant = (variant) => {\n    const product = Products.findOne(variant._id);\n    return applyProductRevision(product);\n  };\n});\n\n/**\n * variantForm helpers\n */\n\nTemplate.variantForm.helpers({\n  variantFormComponent() {\n    return VariantFormContainer;\n  },\n  variant() {\n    const instance = Template.instance();\n    return instance.getVariant(instance.data);\n  },\n  childVariants: function () {\n    const _id = this._id;\n    const variants = ReactionProduct.getVariants();\n    const childVariants = [];\n    variants.map(variant => {\n      if (~variant.ancestors.indexOf(_id) && variant.type !== \"inventory\") {\n        childVariants.push(variant);\n      }\n    });\n    return childVariants;\n  },\n  variantFormId: function () {\n    return \"variant-form-\" + this._id;\n  }\n});\n\n/**\n * variantForm events\n */\n\nTemplate.variantForm.events({\n  \"click .btn-child-variant-form\": function (event, template) {\n    event.stopPropagation();\n    event.preventDefault();\n    const productId = ReactionProduct.selectedProductId();\n\n    if (!productId) {\n      return;\n    }\n\n    Meteor.call(\"products/createVariant\", template.data._id, function (error, result) {\n      if (error) {\n        Alerts.alert({\n          text: i18next.t(\"productDetailEdit.addVariantFail\", { title: template.data.title }),\n          confirmButtonText: i18next.t(\"app.close\", { defaultValue: \"Close\" })\n        });\n      } else if (result) {\n        const newVariantId = result;\n        const selectedProduct = ReactionProduct.selectedProduct();\n        const handle = selectedProduct.__published && selectedProduct.__published.handle || selectedProduct.handle;\n        ReactionProduct.setCurrentVariant(newVariantId);\n        Session.set(\"variant-form-\" + newVariantId, true);\n\n        Reaction.Router.go(\"product\", {\n          handle: handle,\n          variantId: newVariantId\n        });\n      }\n    });\n  }\n});\n"]},"hash":"02504da9aad59dd558cc81d516a3dd89d107a4be"}
